@model MSP_RegProf.Models.EspecialidadPorCentroDeSalud
@using MSP_RegProf.Models


<style>
    legend {
        border-bottom: 1px solid #3c8dbc;
    }

    .btn-circle {
        width: 30px;
        height: 30px;
        text-align: center;
        padding: 6px 0;
        font-size: 12px;
        line-height: 1.428571429;
        border-radius: 15px;
    }
</style>

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    <div class="form-horizontal">
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        @Html.HiddenFor(model => model.ID)

        <div class="container">
            @Html.ValidationSummary(true, "", new { @class = "text-danger" })

            <!-- Grupo 1 -Especialidad -->
            <div class="row">
                <div class="col-md-12">
                    <div class="form-group row">
                        <label class="control-label col-md-2 col-md-offset-1" for="Especialidad">Especialidad:</label>
                        <div class="col-md-8">
                            @Html.DropDownList("EspecialidadID", null, htmlAttributes: new { @class = "form-control" })
                            @Html.ValidationMessageFor(model => model.EspecialidadID, "", new { @class = "text-danger" })
                        </div>
                    </div>
                </div>
            </div>

            

            <!-- Grupo 3 -Dias y Horarios (Mejor programado)-->
            <div class="row">
                <fieldset id="fsDiasYHorarios">
                    <legend>Dias y Horarios:</legend>

                    @for (int i = 1; i <= 7; i++)
                    {
                        <!-- Check @((Dias)i) -->
                        <div class="container">
                            <div class="checkbox">
                                <label>
                                    <input type="checkbox" value="@i">
                                    @((Dias)i)
                                </label>
                            </div>
                            <div id="rowHorario_@(i)_1" class="row">
                                <!-- id="rowHorario_[Id_Dia]_[Nro_Fila]" -->
                                <div class="col-md-5">
                                    <div class="form-group row">
                                        <label class="control-label col-md-4 col-md-offset-2" for="HoraDesde">Desde: </label>
                                        <div class="col-md-4 col-md-offset-1">
                                            <input type="text" class="form-control " id="HoraDesde_@(i)_1" placeholder="08:00">
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-5">
                                    <div class="form-group row">
                                        <label class="control-label col-md-4" for="HoraHasta">Hasta: </label>
                                        <div class="col-md-4 col-md-offset-1">
                                            <input type="text" class="form-control col-md-4 col-md-offset-1" id="HoraHasta_@(i)_1" placeholder="13:00">
                                        </div>
                                    </div>
                                </div>

                                <div id="divBtns_@(i)_1" class="col-md-2">
                                    <button id="btnAdd_@(i)_1" type="button" class="btn btn-success btn-circle"><i class="glyphicon glyphicon-plus"></i></button>
                                    @*<button id="btnDelete_1_1" type="button" class="btn btn-danger btn-circle"><i class="glyphicon glyphicon-minus"></i></button>*@
                                </div>
                            </div>
                        </div>
                    }


                    

                  

                </fieldset>
            </div>

        </div><!-- Fin Container -->





    </div>
}




<script>
    var HorariosCount = {
        Lunes: 1,
        Martes: 1,
        Miercoles: 1,
        Jueves: 1,
        Viernes: 1,
        Sabado: 1,
        Domingo: 1,
    }


    $(function () {
        //Hide all "rowHorario" divs
        $("div[id^='rowHorario']").hide();

        //Bind "change" event to checkboxs
        $("input[type='checkbox']").on("change", ShowOrHideRowOnClick);

        //Bind "click" event to all Add and Delete buttons
        $("button[id^='btnAdd_']").click(AddRow);
        $("button[id^='btnDelete_']").click(DeleteRow);

    });




    function ShowOrHideRowOnClick() {
        if ($(this).is(':checked')) {
            //debugger
            var chkId = $(this).val();
            $("div[id^='rowHorario_" + chkId + "']").show('slow');
        }
        else {
            //debugger
            var chkId = $(this).val();
            $("div[id^='rowHorario_" + chkId + "']").hide('slow');
        }
    }

    function AddRow() {

        debugger
        var split = $(this).attr('id').split('_');

        var currentDiaId = parseInt(split[1]);
        var currentRowId = parseInt(split[2]);

        var currentNroId = '_' + currentDiaId + '_' + currentRowId;
        var newNroId = '_' + currentDiaId + '_' + (currentRowId + 1);

        //var newRowId = 'rowHorario' + newNroId;
        //var newBtnAddId = 'btnAdd' + newNroId;
        //var newBtnDeleteId = 'btnDelete' + newNroId;


        var newRowHtml = '<div id="rowHorario' + newNroId + '" class="row">'
                            + '<div class="col-md-5">'
                                + '<div class="form-group">'
                                    + '<label class="control-label col-md-4 col-md-offset-2" for="HoraDesde">Desde: </label>'
                                    + '<div class="col-md-4 col-md-offset-1">'
                                        + '<input type="text" class="form-control col-md-4 col-md-offset-1" id="HoraDesde_1_1" placeholder="08:00">'
                                    + '</div>'
                                + '</div>'
                            + '</div>'

                            + '<div class="col-md-5">'
                                + '<div class="form-group">'
                                    + '<label class="control-label col-md-4" for="HoraHasta">Hasta: </label>'
                                    + '<div class="col-md-4 col-md-offset-1">'
                                        + '<input type="text" class="form-control col-md-4 col-md-offset-1" id="HoraHasta_1_1" placeholder="13:00">'
                                    + '</div>'
                                + '</div>'
                            + '</div>'

                            + '<div id="divBtns' + newNroId + '" class="col-md-2">'
                                + '<button id="btnAdd' + newNroId + '" type="button" class="btn btn-success btn-circle"><i class="glyphicon glyphicon-plus"></i></button>'
                                + '<button id="btnDelete' + newNroId + '" type="button" class="btn btn-danger btn-circle"><i class="glyphicon glyphicon-minus"></i></button>'
                            + '</div>'
                        + '</div>';


        //AddNewRow(HTML)
        $(this).parent().parent().after(newRowHtml);

        //Hide Buttons
        $('#divBtns' + currentNroId).hide('slow');


        //Bind Events
        $('#btnAdd' + newNroId).on('click', AddRow);
        $('#btnDelete' + newNroId).on('click', DeleteRow);

        //Entrance animation
        $('#rowHorario' + newNroId).hide();
        $('#rowHorario' + newNroId).show('slow');
    }

    function DeleteRow() {
        debugger
        var split = $(this).attr('id').split('_');

        var currentDiaId = parseInt(split[1]);
        var currentRowId = parseInt(split[2]);

        var prevNroId = '_' + currentDiaId + '_' + (currentRowId-1);
        var currentNroId = '_' + currentDiaId + '_' + currentRowId;
        //var newNroId = '_' + currentDiaId + '_' + (currentRowId + 1);
        
        $('#rowHorario' + currentNroId).hide('slow', function () {
            $('#rowHorario' + currentNroId).remove();
        });
        
        $('#divBtns' + prevNroId).show('slow');

    }

</script>